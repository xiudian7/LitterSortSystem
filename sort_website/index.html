<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>狼行天下</title>
    <link href="/styles/base.css" rel="stylesheet" type="text/css">
    <link href="/styles/index.css" rel="stylesheet" type="text/css">
    <link href="/js/plugins/jqPaginator/jqPagination.css" rel="stylesheet" type="text/css">
    <script type="text/javascript" src="/js/jquery/jquery.js"></script>
    <script type="text/javascript" src="/js/plugins/jquery-form/jquery.form.js"></script>
    <script type="text/javascript" src="/js/plugins/jqPaginator/jq-paginator.min.js"></script>
    <script src="/js/vue/md5.js"></script>
    <script src="/js/plugins/js-cookie/js.cookie.min.js"></script>
    <script type="text/javascript" src="/js/vue/common.js"></script>
    <script type="text/javascript" src="/js/system/index/index.js"></script>
    <script src="./js/vue/vue.min.js"></script>
    <script src="/js/vue/system/index/index.js"></script>
</head>
<body>
<div id="navbar">
    <!--导航栏-->
    <script>
        var currentNav = "index";
        $('#navbar').load('/views/common/navbar.html');
    </script>
</div>

        <div class="search-container" id="_j_index_search">
            <div class="search-group">
                <!--<div class="searchtab" id="_j_index_search_tab">
                    <ul class="clearfix">
                        <li class="tab-selected" data-index="-1"><i></i>全部</li>
                        <li data-index="0"><i></i>目的地</li>
                        <li data-index="1"><i></i>攻略</li>
                        <li data-index="2"><i></i>游记</li>
                        <li data-index="3"><i></i>找人</li>
                    </ul>
                </div>-->
                <div class="searchbar" id="_j_index_search_bar_all">
                    <div class="search-wrapper">
                        <div class="search-input">
                            <input name="image" type="file" placeholder="请选择文件" id="upload-image-input" autocomplete="off">
                        </div>
                    </div>
                    <div class="search-button" id="_j_index_search_btn_all">
                        <a role="button" href="javascript:" @click="identifyClick"><i class="icon-search"></i></a>
                    </div>
                </div>

            </div>
        </div>
</body>
<!--<script src="./js/vue/system/index/index.js"></script>-->
<script>
    var vue = new Vue({
        el:".search-container",
        data:{
            page:{},
            // day:getIndexTime(),
            banners:[],
            page:{},
            stBanner:{}
        },
        methods:{
             /*getCookie:function (name){
                var strcookie = document.cookie;//获取cookie字符串
                var arrcookie = strcookie.split("; ");//分割
                //遍历匹配
                for ( var i = 0; i < arrcookie.length; i++) {
                    var arr = arrcookie[i].split("=");
                    if (arr[0] == name){
                        return arr[1];
                    }
                }
                return "";
            },*/
            identifyClick:function () {
                console.log('执行click')
                const inputDom = document.getElementById('upload-image-input')
                const file = inputDom.files[0]
                console.log('input上传的文件：', file)
                const formData = new FormData()
                console.log('user', user)
                formData.append('token', token)
                formData.append('user', JSON.stringify(user))
                const reader = new FileReader()
                reader.readAsDataURL(file)
                reader.onload = ()=>{
                    const base64 = reader.result
                    formData.append('file', base64)
                    fetch("http://localhost:8082/functions/identify", {
                        method: "POST",
                        headers:{
                            "token":getToken()
                        },
                        body: formData
                    })
                        .then(response => {
                            if (!response.ok) {
                                throw new Error('网络错误，请稍后再试！');
                            }
                            return response.json(); // 解析后端返回的JSON数据
                        })
                        .then(data => {
                            // 输出后端返回的data值
                            if(data.code == 200){
                                console.log('后端返回的data值：', data);
                                popup("垃圾类型为："+data.data)
                            }
                            else{
                                popup(data.msg)
                            }

                        });

                }

            }},
        mounted:function () {
        }
    });

    console.log('vue', vue)
</script>
</html>